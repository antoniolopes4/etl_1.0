from utils.config_loader import load_config
conf = load_config("DRR")
print(conf)

from utils.config_loader import load_config
conf = load_config("PRECARIO")
print(conf)

from utils.config_loader import load_config
from extract.csv_extractor import extract
config = load_config("PRECARIO")
df = extract(
    path=config["path"],
    columns=config.get("columns")
)
print(df.head())

from utils.config_loader import load_config
from extract.api_extractor import extract_api
config = load_config("API_TRANSACOES")
df = extract_api(
    base_url=config["base_url"],
    params=config.get("params"),
    pagination_key=config.get("pagination_key"),
    max_pages=config.get("max_pages", 5),
    columns=config.get("columns"),
)
print(df.head())
